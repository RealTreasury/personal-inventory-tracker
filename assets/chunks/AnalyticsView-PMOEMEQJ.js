/*! Personal Inventory Tracker Enhanced */
import{A as h,b as g,c as b,i as f,t as u}from"./chunk-LT2OG7SB.js";var e=g(b());var N=({timeRange:c=30})=>{let[r,w]=(0,e.useState)("purchases"),[p,x]=(0,e.useState)([]),i=(0,e.useRef)(null);(0,e.useEffect)(()=>{(async()=>{var s,l;try{let o=await fetch(`${(s=window.pitApp)==null?void 0:s.restUrl}analytics?range=${c}`,{headers:{"X-WP-Nonce":(l=window.pitApp)==null?void 0:l.nonce}});if(o.ok){let m=await o.json();x(m.items)}}catch(o){}})()},[c]);let d=(0,e.useMemo)(()=>new Date(Date.now()-c*24*60*60*1e3),[c]),a=(0,e.useMemo)(()=>p.filter(t=>new Date(t.last_purchased)>=d),[p,d]),n=(0,e.useMemo)(()=>({purchases:{label:"Recent Purchases",icon:f,filter:()=>!0},lowStock:{label:"Low Stock",icon:h,filter:t=>t.current_qty<t.threshold},expired:{label:"Expired",icon:u,filter:t=>t.expiry&&new Date(t.expiry)<new Date}}),[]),y=(0,e.useMemo)(()=>{let t=n[r];return a.filter(s=>t.filter(s))},[a,n,r]);return(0,e.useEffect)(()=>{let t;async function s(){let{Chart:l}=await import("https://cdn.jsdelivr.net/npm/chart.js@4/dist/chart.esm.js");i.current&&(t=new l(i.current,{type:"bar",data:{labels:["Purchases","Low Stock","Expired"],datasets:[{data:[a.length,a.filter(n.lowStock.filter).length,a.filter(n.expired.filter).length],backgroundColor:["#3b82f6","#f59e0b","#ef4444"]}]},options:{responsive:!0,plugins:{legend:{display:!1}}}}))}return s(),()=>t&&t.destroy()},[a,n]),e.default.createElement("div",{className:"space-y-6"},e.default.createElement("div",{className:"flex space-x-4"},Object.entries(n).map(([t,s])=>{let l=s.icon;return e.default.createElement("button",{key:t,onClick:()=>w(t),className:`flex items-center px-4 py-2 rounded-lg border transition-colors ${r===t?"bg-blue-600 text-white":"bg-white text-gray-700 hover:bg-gray-50"}`},e.default.createElement(l,{className:"h-5 w-5 mr-2"}),e.default.createElement("span",null,s.label),e.default.createElement("span",{className:"ml-2 text-sm text-gray-500"},a.filter(s.filter).length))})),e.default.createElement("canvas",{ref:i,className:"max-w-md"}),e.default.createElement("div",null,e.default.createElement("ul",{className:"divide-y divide-gray-200"},y.map(t=>e.default.createElement("li",{key:t.id,className:"py-2 flex justify-between"},e.default.createElement("span",{className:"font-medium"},t.title),r==="purchases"&&e.default.createElement("span",{className:"text-sm text-gray-500"},new Date(t.last_purchased).toLocaleDateString()),r==="lowStock"&&e.default.createElement("span",{className:"text-sm text-gray-500"},t.current_qty,"/",t.threshold),r==="expired"&&e.default.createElement("span",{className:"text-sm text-gray-500"},t.expiry?new Date(t.expiry).toLocaleDateString():"N/A"))))))},D=N;export{D as default};
